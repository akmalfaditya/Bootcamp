@model StudentManagementMVC.Models.Student

@{
    ViewData["Title"] = "Add New Student";
}

<!-- Page Header -->
<div class="row mb-4">
    <div class="col-12">
        <div class="d-flex justify-content-between align-items-center">
            <div>
                <h1 class="h3 mb-1">
                    <i class="bi bi-person-plus-fill text-primary me-2"></i>Add New Student
                </h1>
                <p class="text-muted mb-0">Fill in the student information below</p>
            </div>
            <a asp-action="Index" class="btn btn-outline-secondary">
                <i class="bi bi-arrow-left me-2"></i>Back to Students
            </a>
        </div>
    </div>
</div>

<!-- Main Form -->
<div class="row justify-content-center">
    <div class="col-lg-8">
        <div class="card border-0 shadow-sm">
            <div class="card-header bg-primary text-white">
                <div class="d-flex align-items-center">
                    <i class="bi bi-person-vcard-fill me-2"></i>
                    <h5 class="mb-0">Student Information</h5>
                </div>
            </div>
            <div class="card-body p-4">
                <form asp-action="Create" method="post" novalidate>
                    @Html.AntiForgeryToken()
                    
                    <!-- Validation Summary -->
                    <div asp-validation-summary="ModelOnly" class="alert alert-danger d-none"></div>

                    <!-- Personal Information Section -->
                    <div class="mb-4">
                        <h6 class="text-primary mb-3 border-bottom pb-2">
                            <i class="bi bi-person me-2"></i>Personal Information
                        </h6>
                        
                        <div class="row g-3">
                            <!-- Full Name -->
                            <div class="col-md-6">
                                <label asp-for="Name" class="form-label fw-semibold">
                                    <i class="bi bi-person-fill me-1"></i>Full Name
                                    <span class="text-danger">*</span>
                                </label>
                                <input asp-for="Name" class="form-control form-control-lg" 
                                       placeholder="Enter student's full name" autocomplete="name">
                                <span asp-validation-for="Name" class="text-danger small"></span>
                            </div>

                            <!-- Gender -->
                            <div class="col-md-6">
                                <label asp-for="Gender" class="form-label fw-semibold">
                                    <i class="bi bi-gender-ambiguous me-1"></i>Gender
                                    <span class="text-danger">*</span>
                                </label>
                                <select asp-for="Gender" class="form-select form-select-lg">
                                    <option value="">Choose gender...</option>
                                    <option value="Male">Male</option>
                                    <option value="Female">Female</option>
                                    <option value="Other">Other</option>
                                </select>
                                <span asp-validation-for="Gender" class="text-danger small"></span>
                            </div>

                            <!-- Email -->
                            <div class="col-12">
                                <label asp-for="Email" class="form-label fw-semibold">
                                    <i class="bi bi-envelope-fill me-1"></i>Email Address
                                    <span class="text-danger">*</span>
                                </label>
                                <div class="input-group input-group-lg">
                                    <span class="input-group-text bg-light">
                                        <i class="bi bi-at"></i>
                                    </span>
                                    <input asp-for="Email" type="email" class="form-control" 
                                           placeholder="student@university.edu" autocomplete="email">
                                </div>
                                <span asp-validation-for="Email" class="text-danger small"></span>
                            </div>

                            <!-- Phone Number (if exists in model) -->
                            <div class="col-12">
                                <label asp-for="PhoneNumber" class="form-label fw-semibold">
                                    <i class="bi bi-telephone-fill me-1"></i>Phone Number
                                </label>
                                <div class="input-group input-group-lg">
                                    <span class="input-group-text bg-light">
                                        <i class="bi bi-phone"></i>
                                    </span>
                                    <input asp-for="PhoneNumber" type="tel" class="form-control" 
                                           placeholder="+1 (555) 123-4567" autocomplete="tel">
                                </div>
                                <span asp-validation-for="PhoneNumber" class="text-danger small"></span>
                            </div>
                        </div>
                    </div>

                    <!-- Academic Information Section -->
                    <div class="mb-4">
                        <h6 class="text-success mb-3 border-bottom pb-2">
                            <i class="bi bi-mortarboard me-2"></i>Academic Information
                        </h6>
                        
                        <div class="row g-3">
                            <!-- Branch/Major -->
                            <div class="col-md-6">
                                <label asp-for="Branch" class="form-label fw-semibold">
                                    <i class="bi bi-building me-1"></i>Branch/Major
                                    <span class="text-danger">*</span>
                                </label>
                                <select asp-for="Branch" class="form-select form-select-lg">
                                    <option value="">Select branch/major...</option>
                                    <option value="Computer Science">Computer Science</option>
                                    <option value="Information Technology">Information Technology</option>
                                    <option value="Software Engineering">Software Engineering</option>
                                    <option value="Data Science">Data Science</option>
                                    <option value="Cybersecurity">Cybersecurity</option>
                                    <option value="Engineering">Engineering</option>
                                    <option value="Business Administration">Business Administration</option>
                                    <option value="Mathematics">Mathematics</option>
                                    <option value="Physics">Physics</option>
                                    <option value="Chemistry">Chemistry</option>
                                </select>
                                <span asp-validation-for="Branch" class="text-danger small"></span>
                            </div>

                            <!-- Section -->
                            <div class="col-md-6">
                                <label asp-for="Section" class="form-label fw-semibold">
                                    <i class="bi bi-diagram-3 me-1"></i>Section
                                    <span class="text-danger">*</span>
                                </label>
                                <select asp-for="Section" class="form-select form-select-lg">
                                    <option value="">Select section...</option>
                                    <option value="A">Section A</option>
                                    <option value="B">Section B</option>
                                    <option value="C">Section C</option>
                                    <option value="D">Section D</option>
                                    <option value="E">Section E</option>
                                </select>
                                <span asp-validation-for="Section" class="text-danger small"></span>
                            </div>

                            <!-- Enrollment Date -->
                            <div class="col-md-6">
                                <label asp-for="EnrollmentDate" class="form-label fw-semibold">
                                    <i class="bi bi-calendar-event me-1"></i>Enrollment Date
                                    <span class="text-danger">*</span>
                                </label>
                                <input asp-for="EnrollmentDate" type="date" class="form-control form-control-lg">
                                <span asp-validation-for="EnrollmentDate" class="text-danger small"></span>
                                <div class="form-text">
                                    <i class="bi bi-info-circle me-1"></i>
                                    Date when the student enrolled in the institution
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Form Actions -->
                    <div class="d-flex gap-3 pt-3 border-top">
                        <button type="submit" class="btn btn-primary btn-lg flex-fill">
                            <i class="bi bi-check-lg me-2"></i>Create Student
                        </button>
                        <a asp-action="Index" class="btn btn-outline-secondary btn-lg">
                            <i class="bi bi-x-lg me-2"></i>Cancel
                        </a>
                    </div>
                </form>
            </div>
        </div>

        <!-- Help Information -->
        <div class="card border-0 bg-light mt-4">
            <div class="card-body">
                <h6 class="text-muted mb-3">
                    <i class="bi bi-lightbulb me-2"></i>Quick Tips
                </h6>
                <div class="row g-3">
                    <div class="col-md-6">
                        <ul class="list-unstyled mb-0">
                            <li class="mb-2">
                                <i class="bi bi-check-circle-fill text-success me-2"></i>
                                All fields marked with <span class="text-danger">*</span> are required
                            </li>
                            <li class="mb-2">
                                <i class="bi bi-check-circle-fill text-success me-2"></i>
                                Use a valid email format
                            </li>
                        </ul>
                    </div>
                    <div class="col-md-6">
                        <ul class="list-unstyled mb-0">
                            <li class="mb-2">
                                <i class="bi bi-check-circle-fill text-success me-2"></i>
                                Enrollment date cannot be in the future
                            </li>
                            <li class="mb-2">
                                <i class="bi bi-check-circle-fill text-success me-2"></i>
                                You can add grades after creating the student
                            </li>
                        </ul>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>

@section Scripts {
    @{await Html.RenderPartialAsync("_ValidationScriptsPartial");}
    
    <script>
        $(document).ready(function() {
            // Set today's date as default and max date for enrollment
            var today = new Date().toISOString().split('T')[0];
            var enrollmentInput = $('#EnrollmentDate');
            
            if (!enrollmentInput.val()) {
                enrollmentInput.val(today);
            }
            enrollmentInput.attr('max', today);
            
            // Show validation summary on form submit with errors
            $('form').on('submit', function(e) {
                var hasErrors = $('.field-validation-error:visible').length > 0;
                if (hasErrors) {
                    $('.alert-danger').removeClass('d-none').show();
                    $('html, body').animate({
                        scrollTop: $('.alert-danger').offset().top - 100
                    }, 500);
                }
            });
            
            // Auto-capitalize names
            $('#Name').on('blur', function() {
                var value = $(this).val().trim();
                if (value) {
                    var words = value.toLowerCase().split(' ');
                    var capitalized = words.map(function(word) {
                        return word.charAt(0).toUpperCase() + word.slice(1);
                    }).join(' ');
                    $(this).val(capitalized);
                }
            });
            
            // Format phone number
            $('#PhoneNumber').on('input', function() {
                var value = $(this).val().replace(/\D/g, '');
                if (value.length >= 10) {
                    var formatted = value.replace(/(\d{3})(\d{3})(\d{4})/, '($1) $2-$3');
                    $(this).val(formatted);
                }
            });
            
            // Real-time validation feedback
            $('input, select').on('blur change', function() {
                var $this = $(this);
                var $validationSpan = $this.siblings('.text-danger');
                
                if ($this.hasClass('input-validation-error')) {
                    $this.removeClass('is-valid').addClass('is-invalid');
                } else if ($this.val() && !$this.hasClass('input-validation-error')) {
                    $this.removeClass('is-invalid').addClass('is-valid');
                }
            });
        });
    </script>
}
